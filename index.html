<script>
window.addEventListener('load', function () {

  const container = document.getElementById('container');
  const width = window.innerWidth;
  const height = window.innerHeight;

  const stage = new Konva.Stage({
    container: container,
    width: width,
    height: height,
  });

  const layer = new Konva.Layer();
  stage.add(layer);

  let points = [];
  let currentLine = null;

  function drawLine() {
    if (currentLine) currentLine.destroy();

    currentLine = new Konva.Line({
      points: points,
      stroke: 'black',
      strokeWidth: 3,
      lineCap: 'round',
      lineJoin: 'round',
    });

    layer.add(currentLine);
    layer.draw();
  }

  stage.on('mousedown touchstart', function () {
    const pos = stage.getPointerPosition();
    points.push(pos.x, pos.y);
    drawLine();
  });

  stage.on('dblclick dbltap', function () {
    points = [];
    currentLine = null;
  });

  window.addEventListener('resize', function () {
    stage.width(window.innerWidth);
    stage.height(window.innerHeight);
  });

});
</script>
